{% liquid
  comment
    Product schema incl. price, availability, review aggregate
  endcomment
  <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"Product",
      "name":"{{ product.title }}",
      "image":[{% for img in product.images %}"{{ img | img_url: '800x' }}"{% unless forloop.last %},{% endunless %}{% endfor %}],
      "description":"{{ product.description | strip_html | truncate: 160 }}",
      "sku":"{{ product.selected_or_first_available_variant.sku }}",
      "mpn":"{{ product.id }}",
      "brand":{"@type":"Brand","name":"{{ brand_name }}"},
      "offers":{
        "@type":"Offer",
        "url":"{{ shop.url }}{{ product.url }}",
        "priceCurrency":"CAD",
        "price":"{{ product.price | money_without_currency }}",
        "availability":"https://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}"
      }{% if product.metafields.reviews.rating_count > 0 %},
      "aggregateRating":{
        "@type":"AggregateRating",
        "ratingValue":"{{ product.metafields.reviews.rating_value }}",
        "reviewCount":"{{ product.metafields.reviews.rating_count }}"
      }{% endif %}
    }
  </script>
{% endliquid %}

<section class="main-product container mx-auto py-8">
  <div class="grid md:grid-cols-2 gap-8">
    <div>
      {% if product.images.size > 0 %}
        <img src="{{ product.featured_image | image_url: width: 600 }}" alt="{{ product.title }} {{ brampton_city }} auto parts" loading="lazy" width="600" height="600" class="w-full h-auto rounded-lg shadow" />
      {% endif %}
    </div>
    <div>
      <h1 class="text-3xl font-bold mb-4">{{ product.title }}</h1>
      <div class="rte mb-6">
        {{ product.description | replace: '<img', '<img alt="' | replace: '>', ' {{ product.title }} {{ brampton_city }} auto parts">' }}
      </div>
      <div class="price text-2xl font-semibold mb-4">{{ product.price | money }}</div>
      {% form 'product', product %}
        <button type="submit" class="btn btn--primary">Add to cart</button>
      {% endform %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Main Product",
  "tag": "section",
  "settings": []
}
{% endschema %}
