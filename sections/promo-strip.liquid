{% if section.settings.show_promo %}
  <section class="promo-strip relative overflow-hidden" style="background-color: {{ section.settings.bg_color }}; color: {{ section.settings.text_color }};">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-center py-3 relative">
        {% if section.settings.announcement_text != blank %}
          <div class="promo-content text-center">
            {% if section.settings.show_icon %}
              <span class="promo-icon mr-2">
                {% if section.settings.icon_type == 'shipping' %}
                  <svg class="w-5 h-5 inline" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M8 5a1 1 0 100 2h5.586l-1.293 1.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L13.586 5H8zM12 15a1 1 0 100-2H6.414l1.293-1.293a1 1 0 10-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L6.414 15H12z"/>
                  </svg>
                {% elsif section.settings.icon_type == 'star' %}
                  <svg class="w-5 h-5 inline" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                {% elsif section.settings.icon_type == 'phone' %}
                  <svg class="w-5 h-5 inline" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
                  </svg>
                {% else %}
                  <svg class="w-5 h-5 inline" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                  </svg>
                {% endif %}
              </span>
            {% endif %}
            
            <span class="promo-text font-medium">
              {{ section.settings.announcement_text }}
            </span>
            
            {% if section.settings.link_url != blank and section.settings.link_text != blank %}
              <a href="{{ section.settings.link_url }}" class="promo-link ml-2 underline hover:no-underline">
                {{ section.settings.link_text }}
              </a>
            {% endif %}
          </div>
        {% endif %}

        {% if section.settings.show_close %}
          <button 
            class="promo-close absolute right-4 top-1/2 transform -translate-y-1/2 w-6 h-6 flex items-center justify-center hover:opacity-70 transition-opacity"
            onclick="this.closest('.promo-strip').style.display='none'"
            aria-label="Close announcement"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
            </svg>
          </button>
        {% endif %}
      </div>
    </div>

    {% if section.settings.show_animation %}
      <div class="promo-animation absolute inset-0 pointer-events-none">
        <div class="promo-shimmer"></div>
      </div>
    {% endif %}
  </section>
{% endif %}

<style>
  .promo-strip {
    position: relative;
    z-index: 10;
    font-size: {{ section.settings.font_size }}px;
  }
  
  .promo-content {
    animation: {% if section.settings.scroll_text %}scroll-text 20s linear infinite{% else %}none{% endif %};
  }
  
  .promo-link {
    transition: all 0.3s ease;
  }
  
  .promo-close {
    transition: all 0.3s ease;
  }
  
  .promo-close:hover {
    transform: translate(-50%, -50%) scale(1.1);
  }
  
  {% if section.settings.show_animation %}
    .promo-shimmer {
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.2),
        transparent
      );
      width: 100%;
      height: 100%;
      animation: shimmer 3s infinite;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
  {% endif %}
  
  {% if section.settings.scroll_text %}
    @keyframes scroll-text {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    
    .promo-strip:hover .promo-content {
      animation-play-state: paused;
    }
  {% endif %}
  
  @media (max-width: 768px) {
    .promo-strip {
      font-size: {{ section.settings.font_size | minus: 2 }}px;
    }
    
    .promo-close {
      right: 8px;
    }
  }
</style>

{% schema %}
{
  "name": "Promo Strip",
  "tag": "section",
  "class": "section section-promo-strip",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_promo",
      "label": "Show announcement bar",
      "default": true
    },
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement text",
      "default": "ðŸšš Free shipping on orders over $75 | Call us: 416-309-1913"
    },
    {
      "type": "url",
      "id": "link_url",
      "label": "Optional link URL"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "Link text",
      "default": "Shop Now"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background color",
      "default": "#3C0007"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "font_size",
      "label": "Font size",
      "min": 12,
      "max": 18,
      "step": 1,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "show_icon",
      "label": "Show icon",
      "default": true
    },
    {
      "type": "select",
      "id": "icon_type",
      "label": "Icon type",
      "options": [
        {
          "value": "shipping",
          "label": "Shipping"
        },
        {
          "value": "star",
          "label": "Star"
        },
        {
          "value": "phone",
          "label": "Phone"
        },
        {
          "value": "info",
          "label": "Info"
        }
      ],
      "default": "shipping"
    },
    {
      "type": "checkbox",
      "id": "show_close",
      "label": "Show close button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "scroll_text",
      "label": "Scrolling text animation",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_animation",
      "label": "Show shimmer animation",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "Promo Strip"
    }
  ]
}
{% endschema %}